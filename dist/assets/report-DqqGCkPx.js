import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */import{initializeApp as b}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";import{getAuth as w,onAuthStateChanged as h}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";import{getFirestore as y,addDoc as A,collection as I}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";const v={apiKey:"AIzaSyCA7rXIeGG7iP181YWpPXfjjQjKemmWfyw",authDomain:"lostnfound-67ee0.firebaseapp.com",projectId:"lostnfound-67ee0",storageBucket:"lostnfound-67ee0.appspot.com",messagingSenderId:"194790650701",appId:"1:194790650701:web:97d7fd597cb2350711bd04",measurementId:"G-LB257QGLV4"},f=b(v),p=w(f),D=y(f),r=t=>document.querySelector(t),s=r("#form-msg"),i=(t,e="")=>{s&&(s.textContent=t,s.className=`help ${e}`)};function S(t){return new Promise((e,n)=>{const o=new FileReader;o.onload=()=>e(o.result),o.onerror=n,o.readAsDataURL(t)})}h(p,t=>{t||(window.location.href="login.html")});const d=r("#report-form"),u=r("#submit-btn");d&&d.addEventListener("submit",async t=>{t.preventDefault();const e=p.currentUser,n=r("#title").value.trim(),o=r("#description").value.trim(),l=r("#category").value,c=r("#location").value,m=document.getElementById("photo").files?.[0];if(!n||!o||!l||!c){i("Please fill all required fields.","err");return}if(!e){i("You must be logged in to submit a post.","err");return}u.disabled=!0,i("Submittingâ€¦");try{let a=null;m&&(a=await S(m));const g={title:n,description:o,category:l,location:c,status:"active",ownerUid:e.uid,ownerEmail:e.email||null,createdAt:new Date().toISOString(),imageUrl:a};await A(I(D,"posts"),g),i("Post submitted!","ok"),window.location.href="main.html"}catch(a){console.error(a),i("Failed to submit. Please try again.","err"),u.disabled=!1}});
