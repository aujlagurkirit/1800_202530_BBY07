import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */import{initializeApp as w}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";import{getAuth as I,signOut as E,onAuthStateChanged as v}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";import{getFirestore as A,collection as B,query as T,orderBy as b,getDocs as D}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";const k={apiKey:"AIzaSyCA7rXIeGG7iP181YWpPXfjjQjKemmWfyw",authDomain:"lostnfound-67ee0.firebaseapp.com",projectId:"lostnfound-67ee0",storageBucket:"lostnfound-67ee0.firebasestorage.app",messagingSenderId:"194790650701",appId:"1:194790650701:web:97d7fd597cb2350711bd04",measurementId:"G-LB257QGLV4"},p=w(k),y=I(p),x=A(p);let r=[],d="recent";const m=document.querySelectorAll(".sort-card"),$=document.getElementById("searchInput"),a=document.getElementById("resultsInfo"),u=document.getElementById("resultsContainer"),c=document.getElementById("postModal"),M=document.getElementById("modalTitle"),P=document.getElementById("modalDesc"),S=document.getElementById("modalLocation"),U=document.getElementById("modalCategory"),j=document.getElementById("modalTime"),l=document.getElementById("modalImage"),f=document.getElementById("modalClose"),g=document.getElementById("logout-btn");g&&g.addEventListener("click",()=>{E(y).then(()=>{window.location.href="login.html"}).catch(t=>console.error("Logout error:",t.message))});function N(t){if(!t)return"";const e=new Date(t);if(Number.isNaN(e.getTime()))return"";const o=(Date.now()-e.getTime())/1e3;if(o<60)return"just now";if(o<3600)return`${Math.floor(o/60)}m ago`;if(o<86400)return`${Math.floor(o/3600)}h ago`;const n=Math.floor(o/86400);return n===1?"1 day ago":n<7?`${n} days ago`:e.toLocaleDateString()}function q(t,e){const o=[...t];return e==="recent"?o.sort((n,s)=>new Date(s.createdAt||0).getTime()-new Date(n.createdAt||0).getTime()):e==="oldest"?o.sort((n,s)=>new Date(n.createdAt||0).getTime()-new Date(s.createdAt||0).getTime()):e==="az"?o.sort((n,s)=>(n.title||"").localeCompare(s.title||"",void 0,{sensitivity:"base"})):e==="za"?o.sort((n,s)=>(s.title||"").localeCompare(n.title||"",void 0,{sensitivity:"base"})):o}function z(t){const e=document.createElement("div");e.classList.add("result-card");const o=t.createdAt?`Posted: ${new Date(t.createdAt).toLocaleString()}`:"";return e.innerHTML=`
    <div class="result-top-row">
      <p class="result-name">${t.title||"Untitled"}</p>
      <p class="result-location">${t.location||"Unknown location"}</p>
    </div>
    <p class="result-desc">${t.description||""}</p>
    <p class="result-time">${o}</p>
  `,e.addEventListener("click",()=>{M.textContent=t.title||"Untitled",P.textContent=t.description||"",S.textContent=t.location||"Unknown location",U.textContent=t.category||"Other",j.textContent=t.createdAt?`${o} (${N(t.createdAt)})`:"",t.imageUrl?(l.src=t.imageUrl,l.style.display="block"):l.style.display="none",c.style.display="block"}),e}function i(t){const e=q(t,d);if(u.innerHTML="",!e.length){a.textContent="No matches found.";return}a.textContent=`${e.length} item(s) found`,e.forEach(o=>{u.appendChild(z(o))})}function G(t){const e=t.toLowerCase().trim();if(e===""){i(r);return}const o=r.filter(n=>{const s=(n.title||"").toLowerCase(),h=(n.description||"").toLowerCase(),C=(n.location||"").toLowerCase(),L=(n.category||"").toLowerCase();return s.includes(e)||h.includes(e)||C.includes(e)||L.includes(e)});i(o)}async function R(){a.textContent="Loading posts...";try{const t=B(x,"posts"),e=T(t,b("createdAt","desc")),o=await D(e);if(r=[],o.forEach(n=>{r.push({id:n.id,...n.data()})}),!r.length){a.textContent="No posts yet. Be the first to make one.",u.innerHTML="";return}i(r)}catch(t){console.error("Error loading posts:",t),a.textContent="Could not load posts. Please try again later."}}m.forEach(t=>{t.addEventListener("click",()=>{if(t.classList.contains("active")){t.classList.remove("active"),d="recent",i(r);return}m.forEach(o=>o.classList.remove("active")),t.classList.add("active"),d=t.dataset.sort||"recent",G($.value)})});f&&f.addEventListener("click",()=>{c.style.display="none"});window.addEventListener("click",t=>{t.target===c&&(c.style.display="none")});v(y,t=>{if(!t){window.location.href="login.html";return}R()});
